---
title: "Projet"
author: "Perrin Kyllian / Trouvin Paul"
date: "21 mars 2017"
output: pdf_document
---

TODO :The R Markdown (to be written in RStudio) must contain:

Frontpage
  Title
  Student's name
Table of contents
Introduction
  Context / Dataset description
    How the dataset has been obtained?
  Description of the question
Methodology
  Data clean-up procedures
  Scientific workflow
  Data representation choices
Analysis in Literate Programming
Conclusion
References

Rendu : [L3.MIAGE]TROUVIN PERRIN 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr);
library(magrittr);
library(ggplot2);
library(dplyr);
library(reshape);
```
Choix d'une table de donnée avec 3 questions. CHaque table doit être different d'un groupe a l'autre.
IL faudras écrire les question sur un README_PROJET.md
Une difficultée croissant est appréciée
Méthodologie a faire.
Choix : Population des 16 ans ou plus selon le niveau de diplôme, le sexe et l'âge de 1968 à 2013 
https://www.insee.fr/fr/statistiques/1893149
Présentation la semaine après les examens.

```{r}
pop75 <- read.csv(file="pop-dip-75.csv", header=TRUE, sep=";");
pop82 <- read.csv(file="pop-dip-82.csv", header=TRUE, sep=";");
pop90 <- read.csv(file="pop-dip-90.csv", header=TRUE, sep=";");
pop99 <- read.csv(file="pop-dip-99.csv", header=TRUE, sep=";");
pop08 <- read.csv(file="pop-dip-08.csv", header=TRUE, sep=";");
pop13 <- read.csv(file="pop-dip-13.csv", header=TRUE, sep=";");
data <- rbind(pop75 %>% mutate(annee = 1975),rbind(rbind(rbind(rbind( pop08 %>% mutate(annee = 2008),pop13 %>% mutate(annee = 2013)),pop99 %>% mutate(annee = 1999)),pop90 %>% mutate(annee = 1990)),pop82 %>% mutate(annee = 1982) ))
data
```
Quel est l'évolution du niveau d'étude des populations en fonction de l'age et du sexe ?

```{r}
temp<-melt(data,id=c("annee","RR15","DR15","LIBELLE15"));
table<-mutate(temp,sexe = ifelse(variable == "X16_25_H_non_dip",'H',ifelse(variable == "X25_H_non_dip",'H',ifelse(variable == "X16_25_H_bep",'H',ifelse(variable == "X25_H_non_dip",'H',ifelse(variable == "X16_25_H_Bac",'H',ifelse(variable == "X25_H_Bac",'H',ifelse(variable == "X16_25_H_sup",'H',ifelse(variable == "X25_H_sup",'H','F'))))))))) %>%
mutate(age = ifelse(variable == "X16_25_H_non_dip","16-25",ifelse(variable == "X16_25_F_non_dip","16-25",ifelse(variable == "X16_25_H_bep","16-25",ifelse(variable == "X16_25_F_non_dip","16-25",ifelse(variable == "X16_25_H_Bac","16-25",ifelse(variable == "X16_25_F_Bac","16-25",ifelse(variable == "X16_25_H_sup","16-25",ifelse(variable == "X16_25_F_sup","16-25","25+"))))))))) %>%
mutate(dip = ifelse(variable == "X16_25_H_non_dip","aucun",ifelse(variable == "X25_H_non_dip","aucun",ifelse(variable == "X16_25_F_non_dip","aucun",ifelse(variable == "X25_F_non_dip","aucun",ifelse(variable == "X16_25_H_bep","bac-1",ifelse(variable == "X25_H_bep","bac-1",ifelse(variable == "X16_25_F_sup","bac-1",ifelse(variable == "X25_F_bep","bac-1",ifelse(variable == "X16_25_H_Bac","bac",ifelse(variable == "X25_H_Bac","bac",ifelse(variable == "X16_25_F_Bac","bac",ifelse(variable == "X25_F_Bac","bac","bac+"))))))))))))) %>% select(annee,RR15,DR15,LIBELLE15,sexe,age,dip,value)
table %>% filter(dip=="bac")
```




```{R}
tablepays<-select(table,annee,sexe,age,dip,value) %>% group_by(annee,sexe,age,dip) %>% summarise(value=sum(value))
tablepays
```
Evolution de la population par personne: 
```{R}
tableeff <- tablepays %>% group_by(annee,dip)%>% summarize(value=sum(value))
tableeff  %>% ggplot(aes(x=annee,y=value,colour=dip)) + geom_point() +geom_line()
```
 Ajout de la distinction homme femme  et de l'age sur ce même graph pour non diplômés
```{R}
tablepays %>% filter(dip=="aucun") %>% ggplot(aes(x=annee,y=value,color=sexe,linetype=age, shape=age)) + geom_line() + geom_point()
```

On remarque grâce à ce graphique le peu de difference dans la variation de l'éducation entre les genres. On remarque également que la population en général a une tendence a s'éduquer de plus en plus. Logiquement, le nombre de diplomés devrait augmenter, nous allons donc examiner cela :

```{R}

```